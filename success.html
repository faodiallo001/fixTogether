<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Your private FixTogether link</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg-main: #020617; /* bleu nuit */
      --bg-card: rgba(12, 19, 38, 0.96);
      --accent: #3b82f6;
      --accent-soft: #60a5fa;
      --warm-main: #f7e6b5;
      --warm-soft: #e7c880;
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --border-subtle: rgba(148, 163, 184, 0.25);
      --radius-xl: 24px;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background:
        radial-gradient(circle at top, #0b1120 0, #020617 50%, #000 100%);
      color: var(--text-main);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px 16px;
    }

    .card {
      max-width: 540px;
      width: 100%;
      background: var(--bg-card);
      border-radius: 24px;
      padding: 24px 22px 22px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      box-shadow: 0 24px 80px rgba(15, 23, 42, 0.9);
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: -40%;
      opacity: 0.18;
      background:
        radial-gradient(circle at 0% 0%, rgba(96, 165, 250, 0.23), transparent 55%),
        radial-gradient(circle at 100% 100%, rgba(250, 204, 21, 0.2), transparent 55%);
      pointer-events: none;
      z-index: -1;
      filter: blur(2px);
    }

    .eyebrow {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: var(--text-muted);
      margin-bottom: 6px;
    }

    h1 {
      font-size: 22px;
      margin-bottom: 8px;
      letter-spacing: 0.03em;
      text-transform: uppercase;
    }

    h1 span {
      background: linear-gradient(120deg, #38bdf8, #6366f1, #facc15);
      -webkit-background-clip: text;
      color: transparent;
    }

    p {
      font-size: 14px;
      color: var(--text-muted);
      margin-bottom: 14px;
      line-height: 1.6;
    }

    .steps-title {
      font-size: 13px;
      font-weight: 600;
      margin-top: 8px;
      margin-bottom: 8px;
    }

    .steps {
      display: grid;
      grid-template-columns: minmax(0, 1fr);
      gap: 6px;
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 16px;
    }

    .step {
      display: flex;
      gap: 8px;
      align-items: flex-start;
    }

    .step-badge {
      width: 18px;
      height: 18px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      color: var(--accent-soft);
      flex-shrink: 0;
      margin-top: 1px;
    }

    .step-text {
      line-height: 1.5;
    }

    .link-block-label {
      font-size: 12px;
      margin-bottom: 6px;
      color: var(--text-main);
      font-weight: 500;
    }

    .link-row {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }

    .link-input {
      flex: 1;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.9);
      color: var(--text-main);
      padding: 8px 10px;
      font-size: 12px;
    }

    .btn-primary {
      border-radius: 999px;
      padding: 8px 16px;
      border: none;
      background: linear-gradient(120deg, var(--accent), var(--warm-soft));
      color: #0b1120;
      font-size: 12px;
      cursor: pointer;
      font-weight: 600;
      box-shadow: 0 16px 40px rgba(250, 204, 21, 0.4);
      white-space: nowrap;
      letter-spacing: 0.03em;
      text-transform: uppercase;
      transition:
        transform 0.15s ease,
        box-shadow 0.15s ease,
        opacity 0.15s ease,
        filter 0.15s ease;
    }

    .btn-primary:hover {
      opacity: 0.97;
      transform: translateY(-1px) scale(1.01);
      filter: saturate(1.05);
      box-shadow: 0 22px 55px rgba(234, 179, 8, 0.55);
    }

    .hint {
      margin-top: 4px;
      font-size: 11px;
      color: #6b7280;
      margin-bottom: 14px;
    }

    .msg-label {
      font-size: 12px;
      margin-bottom: 4px;
      color: var(--text-main);
      font-weight: 500;
    }

    .msg-area {
      width: 100%;
      border-radius: 14px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.9);
      color: var(--text-main);
      padding: 8px 10px;
      font-size: 12px;
      resize: vertical;
      min-height: 80px;
      line-height: 1.5;
    }

    .msg-area::placeholder {
      color: #6b7280;
    }

    .msg-hint {
      font-size: 11px;
      color: #6b7280;
      margin-top: 4px;
    }
  </style>
</head>
<body>
  <div class="card">
    <div class="eyebrow">Step 2 · Share the link</div>
    <h1><span>Send this link</span> to the other person</h1>
    <p id="introText">
      We’ve created a private page where they can read your side and answer in
      their own words — calmly, in writing, without pressure.
    </p>

    <div class="steps-title">What to do now</div>
    <div class="steps">
      <div class="step">
        <div class="step-badge">1</div>
        <div class="step-text">Copy the link below.</div>
      </div>
      <div class="step">
        <div class="step-badge">2</div>
        <div class="step-text">
          Send it by WhatsApp, SMS or email with the message below (or your own words).
        </div>
      </div>
      <div class="step">
        <div class="step-badge">3</div>
        <div class="step-text">
          When they answer, FixTogether will read both sides and send one calm message
          to both of your emails.
        </div>
      </div>
    </div>

    <div class="link-block-label">Your private FixTogether link</div>
    <div class="link-row">
      <input id="linkInput" class="link-input" type="text" readonly />
      <button id="copyBtn" class="btn-primary">Copy link</button>
    </div>
    <div class="hint">
      You can reuse this link if you want to resend it later to the same person.
    </div>

    <div class="msg-label">Suggested message to send with the link</div>
    <textarea id="msgArea" class="msg-area"></textarea>
    <div class="msg-hint">
      You can edit this message before sending it on WhatsApp, SMS or email.
    </div>
  </div>

  <script>
    const params = new URLSearchParams(window.location.search);
    const dataParam = params.get("data");

    const origin = window.location.origin || "";
    const linkInput = document.getElementById("linkInput");
    const copyBtn = document.getElementById("copyBtn");
    const msgArea = document.getElementById("msgArea");

    let senderName = "someone";

    if (dataParam) {
      try {
        const base64 = decodeURIComponent(dataParam);
        const json = decodeURIComponent(escape(atob(base64)));
        const parsed = JSON.parse(json);

        if (parsed && parsed.name && parsed.name.trim()) {
          senderName = parsed.name.trim();
        }

        const replyUrl = `${origin}/reply.html?data=${encodeURIComponent(base64)}`;
        linkInput.value = replyUrl;

        const suggested = `Hi, it’s ${senderName}.

I used FixTogether to help us calmly fix something between us.
This link is a private page where you can read my version and share yours in your own time.

When we both answer, FixTogether will send one neutral message to both of our emails, so we can move forward more peacefully.

Here is the link:
${replyUrl}`;

        msgArea.value = suggested;
      } catch (e) {
        console.error("Could not decode data", e);
        linkInput.value = origin + "/reply.html";
        msgArea.placeholder = "Hi, it’s me. Can we use this link to calmly fix what happened?";
      }
    } else {
      linkInput.value = origin + "/reply.html";
      msgArea.placeholder = "Hi, it’s me. Can we use this link to calmly fix what happened?";
    }

    copyBtn.addEventListener("click", async () => {
      try {
        await navigator.clipboard.writeText(linkInput.value);
        copyBtn.textContent = "Copied";
        setTimeout(() => (copyBtn.textContent = "Copy link"), 1500);
      } catch (err) {
        alert("Could not copy. Please copy manually.");
      }
    });
  </script>
</body>
</html>





